# -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
# Pbk2IconCustomApiTestModule.cfg
# phonebook_2_contact_related_icon_customization_api test script for STIF
# -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --

[Define]

EReallySmall 0
ESmall       1
EMedium      2
EMediumLarge 3
ELarge       4

NULL 0

EPsKeyIconUpdaterEnabled 1
EPsKeyIconUpdaterIntervalMs 2
EPsKeyNotificationEventType 3
EPsKeyNotificationEmptyUidArray 4

TEventType::EIconsMajorChange 0
TEventType::EIconsUpdated 1
TEventType::EIconsRemoved 2
TEventType::EIconsAdded 3

ETrue 1
EFalse 0

// Async signal completion codes
KUpdateSignalReceived 1

[Enddefine]


# -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
# ModTest 001: Load icons
#
# 
# -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
[Test]
title ModTest 001: Load icons
create Pbk2IconCustomApiTestModule client
client LoadTestPluginL
client LoadIconsL EMedium
client DeleteIconsL
delete client
[Endtest]

# -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
# ModTest 002: Load icon
#
# 
# -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
[Test]
title ModTest 002: Load icon
create Pbk2IconCustomApiTestModule client
client LoadTestPluginL
client LoadIconL EMedium 0501234567
client DeleteIconL
delete client
[Endtest]

# -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
# ModTest 003: Verify icon match from array
#
# 
# -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
[Test]
title ModTest 003: Verify icon match from array
create Pbk2IconCustomApiTestModule client
client LoadTestPluginL
client LoadIconsL EMedium
client IconChoiceL 0501234567
client DeleteIconsL
delete client
[Endtest]


# -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
# ModTest 004: Major change notification twice
#
# Setup plugin to periodically nofity of icon change, use default update params:
#  - event type = EIconsMajorChange
#  - icon id array is empty
# Register test case as observer
# Listen to notifications (twice)
# 
# -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
[Test]
title ModTest 004: Major change notification twice
create Pbk2IconCustomApiTestModule client
client SetPsProperty EPsKeyIconUpdaterEnabled ETrue
client SetPsProperty EPsKeyIconUpdaterIntervalMs 500
client LoadTestPluginL
client SetTestCaseAsObserverL ETrue
client LoadIconsL EMedium
client IconChoiceL 0501234567
allownextresult TEventType::EIconsMajorChange
waittestclass client
allownextresult TEventType::EIconsMajorChange
waittestclass client
client SetTestCaseAsObserverL EFalse
client DeleteIconsL
client DeletePsProperty EPsKeyIconUpdaterEnabled
client DeletePsProperty EPsKeyIconUpdaterIntervalMs
delete client
[Endtest]


# -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
# ModTest 005: Update notification with refresh icon call
#
# Setup plugin to periodically nofity of icon change with params
#    - event type is EIconsUpdated
#    - icon id array is not empty (i.e. plug-in generates an id list)
# Register test case as observer
# Listen to notification from plugin
# Request plugin for a new updated icon
# 
# -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
[Test]
title ModTest 005: Update notification with refresh icon call
create Pbk2IconCustomApiTestModule client
client SetPsProperty EPsKeyIconUpdaterEnabled ETrue
client SetPsProperty EPsKeyIconUpdaterIntervalMs 500
client SetPsProperty EPsKeyNotificationEventType TEventType::EIconsUpdated
client SetPsProperty EPsKeyNotificationEmptyUidArray EFalse
client LoadTestPluginL
client SetTestCaseAsObserverL ETrue
client LoadIconsL EMedium
client IconChoiceL 0501234567
allownextresult TEventType::EIconsUpdated
waittestclass client
client SetTestCaseAsObserverL EFalse
client UpdateIconsWithLastIconIdsL EMedium
client DeleteIconsL
client DeletePsProperty EPsKeyIconUpdaterEnabled
client DeletePsProperty EPsKeyIconUpdaterIntervalMs
delete client
[Endtest]


# -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
# ModTest 006: Verify extension interface functionality
#
# Setup plugin to periodically nofity of icon change with params
#    - event type is EIconsUpdated
#    - icon id array is not empty (i.e. plug-in generates an id list)
# Register test case as observer
# Listen to notification from plugin
# Request plugin for a new updated icon
# 
# -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
[Test]
title ModTest 006: Verify extension interface functionality
create Pbk2IconCustomApiTestModule client
client LoadTestPluginL
client CheckIfHasExtensionL NULL EFalse 
delete client
[Endtest]
